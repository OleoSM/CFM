<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CEFIMAT Asesorias - Plataforma de Cuestionarios</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: { sans: ['Inter', 'system-ui', 'sans-serif'] }
                }
            }
        }
    </script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap');
        
        * { box-sizing: border-box; }
        
        body { 
            font-family: 'Inter', system-ui, sans-serif; 
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 50%, #f8fafc 100%);
            min-height: 100vh;
            transition: background 0.3s;
        }

        body.dark { 
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #0f172a 100%);
        }

        .glass-light {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(0, 0, 0, 0.08);
        }

        .glass-dark {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.08);
        }

        .fade-in { animation: fadeIn 0.5s ease-out; }
        @keyframes fadeIn { 
            from { opacity: 0; transform: translateY(20px); } 
            to { opacity: 1; transform: translateY(0); } 
        }

        .responsive-container {
            width: 100%; 
            min-height: 100vh;
            display: flex; 
            flex-direction: column;
        }

        @media (min-width: 768px) {
            body { 
                display: flex; 
                align-items: center; 
                justify-content: center; 
                padding: 2rem; 
            }
            .responsive-container {
                max-width: 1000px; 
                min-height: auto;
                height: 90vh; 
                max-height: 800px;
                border-radius: 2rem;
                overflow: hidden;
            }
        }

        .custom-scrollbar::-webkit-scrollbar { width: 4px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(99, 102, 241, 0.3); border-radius: 10px; }

        .subject-card {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            text-decoration: none;
        }
        .subject-card:not(.locked)::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, transparent 100%);
            opacity: 0;
            transition: opacity 0.3s;
        }
        .subject-card:not(.locked):hover::before { opacity: 1; }
        .subject-card:not(.locked):hover { 
            transform: translateY(-8px) scale(1.02); 
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        }
        .subject-card.locked {
            opacity: 0.5;
            cursor: not-allowed;
            filter: grayscale(50%);
        }

        .gradient-text {
            background: linear-gradient(135deg, #6366f1, #a855f7, #ec4899);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .social-link {
            transition: all 0.2s;
        }
        .social-link:hover {
            transform: translateY(-2px);
        }

        .theme-toggle:hover {
            transform: rotate(180deg);
        }

        .shake {
            animation: shake 0.5s ease-in-out;
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
    </style>
</head>
<body id="body">
    <div id="app" class="responsive-container"></div>

    <script>
        // State
        const state = {
            darkMode: localStorage.getItem('darkMode') !== 'false',
            userName: localStorage.getItem('userName') || '',
            userGroup: localStorage.getItem('userGroup') || ''
        };

        function isUnlocked() {
            return state.userName.trim().length > 0 && state.userGroup.trim().length > 0;
        }

        // Toggle dark mode
        function toggleDarkMode() {
            state.darkMode = !state.darkMode;
            localStorage.setItem('darkMode', state.darkMode);
            applyTheme();
        }

        function applyTheme() {
            const body = document.getElementById('body');
            if (state.darkMode) {
                body.classList.add('dark');
            } else {
                body.classList.remove('dark');
            }
            render();
        }

        // Save user data (only on blur, not on every keystroke)
        function saveUserName() {
            const input = document.getElementById('userName');
            if (input) {
                state.userName = input.value;
                localStorage.setItem('userName', state.userName);
                render();
            }
        }

        function saveUserGroup() {
            const input = document.getElementById('userGroup');
            if (input) {
                state.userGroup = input.value;
                localStorage.setItem('userGroup', state.userGroup);
                render();
            }
        }

        function handleIngresar() {
            // Guardar valores actuales
            const nameInput = document.getElementById('userName');
            const groupInput = document.getElementById('userGroup');
            
            if (nameInput) {
                state.userName = nameInput.value;
                localStorage.setItem('userName', state.userName);
            }
            if (groupInput) {
                state.userGroup = groupInput.value;
                localStorage.setItem('userGroup', state.userGroup);
            }

            // Verificar si estÃ¡n completos
            if (isUnlocked()) {
                // Mostrar mensaje de bienvenida
                showToast(`Bienvenido, ${state.userName}!`);
            } else {
                // Shake si faltan datos
                const userInfo = document.getElementById('userInfoCard');
                if (userInfo) {
                    userInfo.classList.add('shake');
                    setTimeout(() => userInfo.classList.remove('shake'), 500);
                }
                if (!state.userName.trim()) {
                    document.getElementById('userName')?.focus();
                } else if (!state.userGroup.trim()) {
                    document.getElementById('userGroup')?.focus();
                }
            }
            render();
        }

        function showToast(msg) {
            const existing = document.querySelector('.toast-msg');
            if (existing) existing.remove();
            
            const toast = document.createElement('div');
            toast.className = 'toast-msg fixed bottom-4 left-1/2 -translate-x-1/2 px-4 py-2 rounded-xl bg-emerald-500 text-white text-sm font-medium shadow-lg z-50';
            toast.textContent = msg;
            document.body.appendChild(toast);
            setTimeout(() => toast.remove(), 2000);
        }

        function handleSubjectClick(e, url) {
            if (!isUnlocked()) {
                e.preventDefault();
                const userInfo = document.getElementById('userInfoCard');
                if (userInfo) {
                    userInfo.classList.add('shake');
                    setTimeout(() => userInfo.classList.remove('shake'), 500);
                }
                return false;
            }
            window.location.href = url;
        }

        function render() {
            const app = document.getElementById('app');
            const isDark = state.darkMode;
            const unlocked = isUnlocked();
            
            const glassClass = isDark ? 'glass-dark' : 'glass-light';
            const textPrimary = isDark ? 'text-white' : 'text-slate-900';
            const textSecondary = isDark ? 'text-slate-400' : 'text-slate-600';
            const textMuted = isDark ? 'text-slate-500' : 'text-slate-400';
            const borderColor = isDark ? 'border-white/5' : 'border-black/5';
            const inputBg = isDark ? 'bg-white/5 text-white placeholder-slate-500' : 'bg-black/5 text-slate-900 placeholder-slate-400';
            const lockedClass = unlocked ? '' : 'locked';

            app.className = `responsive-container ${glassClass}`;

            app.innerHTML = `
                <!-- Header -->
                <div class="px-6 py-5 border-b ${borderColor} flex items-center justify-between">
                    <div class="flex items-center gap-3">
                        <div class="w-12 h-12 rounded-xl bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center shadow-lg">
                            <i data-lucide="play-circle" class="w-6 h-6 text-white"></i>
                        </div>
                        <div>
                            <h1 class="text-lg font-bold ${textPrimary}">CEFIMAT</h1>
                            <p class="text-[10px] ${textMuted} uppercase tracking-wider">Centro Fisico-Matematico</p>
                        </div>
                    </div>
                    <button onclick="toggleDarkMode()" class="theme-toggle w-9 h-9 rounded-xl ${glassClass} flex items-center justify-center ${textSecondary} hover:text-indigo-500 transition-all">
                        <i data-lucide="${isDark ? 'sun' : 'moon'}" class="w-4 h-4"></i>
                    </button>
                </div>

                <!-- Content -->
                <div class="flex-1 overflow-y-auto custom-scrollbar p-6">
                    <div class="max-w-4xl mx-auto space-y-8 fade-in">
                        <!-- Hero -->
                        <div class="text-center space-y-4 py-2">
                            <div class="inline-flex items-center gap-2 px-4 py-2 rounded-full ${glassClass} text-xs text-indigo-500 font-medium">
                                <i data-lucide="sparkles" class="w-3 h-3"></i>
                                INGRESO A LICENCIATURA
                            </div>
                            <h2 class="text-4xl md:text-5xl font-black ${textPrimary} leading-tight">
                                Prepara tu<br>
                                <span class="gradient-text">Examen</span>
                            </h2>
                        </div>

                        <!-- User Info (Centro) -->
                        <div id="userInfoCard" class="${glassClass} rounded-2xl p-6 ${!unlocked ? 'ring-2 ring-indigo-500/50' : ''}">
                            <div class="text-center mb-4">
                                <p class="${textSecondary} text-sm">
                                    ${unlocked 
                                        ? `<i data-lucide="check-circle" class="w-4 h-4 inline mr-1 text-emerald-500"></i>Bienvenido, <strong class="${textPrimary}">${state.userName}</strong>`
                                        : `<i data-lucide="lock" class="w-4 h-4 inline mr-1 text-amber-500"></i>Ingresa tus datos para desbloquear las materias`
                                    }
                                </p>
                            </div>
                            <div class="flex flex-col sm:flex-row gap-4">
                                <div class="flex-1">
                                    <label class="block text-xs ${textSecondary} mb-2 font-medium">
                                        <i data-lucide="user" class="w-3 h-3 inline mr-1"></i>Nombre del Alumno
                                    </label>
                                    <input 
                                        type="text" 
                                        id="userName"
                                        value="${state.userName}"
                                        onblur="saveUserName()"
                                        onkeydown="if(event.key==='Enter')handleIngresar()"
                                        placeholder="Tu nombre..."
                                        class="w-full px-4 py-3 rounded-xl ${inputBg} border ${borderColor} focus:outline-none focus:ring-2 focus:ring-indigo-500/50 text-sm"
                                    >
                                </div>
                                <div class="flex-1">
                                    <label class="block text-xs ${textSecondary} mb-2 font-medium">
                                        <i data-lucide="users" class="w-3 h-3 inline mr-1"></i>Grupo
                                    </label>
                                    <input 
                                        type="text" 
                                        id="userGroup"
                                        value="${state.userGroup}"
                                        onblur="saveUserGroup()"
                                        onkeydown="if(event.key==='Enter')handleIngresar()"
                                        placeholder="Tu grupo..."
                                        class="w-full px-4 py-3 rounded-xl ${inputBg} border ${borderColor} focus:outline-none focus:ring-2 focus:ring-indigo-500/50 text-sm"
                                    >
                                </div>
                                <div class="flex items-end">
                                    <button 
                                        onclick="handleIngresar()"
                                        class="w-full sm:w-auto px-6 py-3 rounded-xl bg-gradient-to-r from-indigo-500 to-purple-600 text-white font-bold text-sm hover:opacity-90 transition-opacity flex items-center justify-center gap-2"
                                    >
                                        <i data-lucide="log-in" class="w-4 h-4"></i>
                                        Ingresar
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Materias Grid -->
                        <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
                            <!-- Historia de Mexico -->
                            <a href="#" onclick="handleSubjectClick(event, 'historia_mexico.html')" class="subject-card ${lockedClass} p-6 rounded-2xl bg-emerald-500/10 border border-emerald-500/20 flex flex-col items-center gap-4">
                                <div class="w-16 h-16 rounded-xl bg-gradient-to-br from-emerald-500 to-teal-600 flex items-center justify-center shadow-lg">
                                    <i data-lucide="scroll-text" class="w-7 h-7 text-white"></i>
                                </div>
                                <div class="text-center">
                                    <span class="text-sm font-bold text-emerald-500">Historia de Mexico</span>
                                    <p class="text-xs ${textMuted} mt-1">8 unidades disponibles</p>
                                </div>
                                ${!unlocked ? `<i data-lucide="lock" class="w-4 h-4 ${textMuted} absolute top-3 right-3"></i>` : ''}
                            </a>

                            <!-- Historia Universal -->
                            <a href="#" onclick="handleSubjectClick(event, 'historia_universal.html')" class="subject-card ${lockedClass} p-6 rounded-2xl bg-indigo-500/10 border border-indigo-500/20 flex flex-col items-center gap-4">
                                <div class="w-16 h-16 rounded-xl bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center shadow-lg">
                                    <i data-lucide="globe-2" class="w-7 h-7 text-white"></i>
                                </div>
                                <div class="text-center">
                                    <span class="text-sm font-bold text-indigo-500">Historia Universal</span>
                                    <p class="text-xs ${textMuted} mt-1">8 unidades disponibles</p>
                                </div>
                                ${!unlocked ? `<i data-lucide="lock" class="w-4 h-4 ${textMuted} absolute top-3 right-3"></i>` : ''}
                            </a>

                            <!-- Geografia -->
                            <a href="#" onclick="handleSubjectClick(event, 'geografia.html')" class="subject-card ${lockedClass} p-6 rounded-2xl bg-amber-500/10 border border-amber-500/20 flex flex-col items-center gap-4">
                                <div class="w-16 h-16 rounded-xl bg-gradient-to-br from-amber-500 to-orange-600 flex items-center justify-center shadow-lg">
                                    <i data-lucide="map" class="w-7 h-7 text-white"></i>
                                </div>
                                <div class="text-center">
                                    <span class="text-sm font-bold text-amber-500">Geografia</span>
                                    <p class="text-xs ${textMuted} mt-1">2 unidades disponibles</p>
                                </div>
                                ${!unlocked ? `<i data-lucide="lock" class="w-4 h-4 ${textMuted} absolute top-3 right-3"></i>` : ''}
                            </a>
                        </div>

                        <!-- Proximas materias -->
                        <div class="${glassClass} rounded-2xl p-4 text-center">
                            <p class="text-xs ${textSecondary}">
                                <i data-lucide="clock" class="w-3 h-3 inline mr-1"></i>
                                Mas materias proximamente: Literatura, Filosofia, Matematicas, Fisica, Quimica, Biologia, Espanol
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Footer -->
                <div class="px-6 py-4 border-t ${borderColor}">
                    <div class="flex flex-col sm:flex-row items-center justify-between gap-4">
                        <span class="text-[10px] ${textMuted} uppercase tracking-wider">CEFIMAT Asesorias 2026</span>
                        
                        <!-- Redes Sociales -->
                        <div class="flex items-center gap-4">
                            <a href="https://open.spotify.com/show/2DRzqIw2dT4negDqeROJCx?si=bbd8e97059c44c04" target="_blank" class="social-link flex items-center gap-2 ${textSecondary} hover:text-green-500 transition-colors">
                                <i data-lucide="music" class="w-4 h-4"></i>
                                <span class="text-xs hidden sm:inline">Spotify</span>
                            </a>
                            <a href="https://www.facebook.com/cefimatasesorias" target="_blank" class="social-link flex items-center gap-2 ${textSecondary} hover:text-blue-500 transition-colors">
                                <i data-lucide="facebook" class="w-4 h-4"></i>
                                <span class="text-xs hidden sm:inline">Facebook</span>
                            </a>
                            <a href="https://www.instagram.com/cefimat" target="_blank" class="social-link flex items-center gap-2 ${textSecondary} hover:text-pink-500 transition-colors">
                                <i data-lucide="instagram" class="w-4 h-4"></i>
                                <span class="text-xs hidden sm:inline">Instagram</span>
                            </a>
                            <a href="https://www.tiktok.com/@cefimat.asesorias" target="_blank" class="social-link flex items-center gap-2 ${textSecondary} hover:text-slate-100 transition-colors">
                                <i data-lucide="video" class="w-4 h-4"></i>
                                <span class="text-xs hidden sm:inline">TikTok</span>
                            </a>
                            <a href="https://www.cefimat.com/" target="_blank" class="social-link flex items-center gap-2 ${textSecondary} hover:text-indigo-500 transition-colors">
                                <i data-lucide="globe" class="w-4 h-4"></i>
                                <span class="text-xs hidden sm:inline">Web</span>
                            </a>
                        </div>
                        
                        <div class="flex items-center gap-2">
                            <div class="w-2 h-2 rounded-full bg-emerald-500 animate-pulse"></div>
                            <span class="text-[10px] text-emerald-500 uppercase tracking-wider font-bold">Activo</span>
                        </div>
                    </div>
                </div>
            `;

            lucide.createIcons();
            
            // Restore cursor position in inputs
            const nameInput = document.getElementById('userName');
            const groupInput = document.getElementById('userGroup');
            if (nameInput && document.activeElement?.id === 'userName') {
                nameInput.focus();
            }
            if (groupInput && document.activeElement?.id === 'userGroup') {
                groupInput.focus();
            }
        }

        // Init
        applyTheme();
    </script>
</body>
</html>
